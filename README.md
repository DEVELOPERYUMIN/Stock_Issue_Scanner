# Stock_Issue_Scanner
> 2026.02~ |

# ğŸ“Œ í”„ë¡œì íŠ¸ëª…: (ê°€ì¹­) IssueFlow Scanner
> ì½”ìŠ¤í”¼/ì½”ìŠ¤ë‹¥ ëŒ€ìƒ â€œì´ìŠˆ(ë‰´ìŠ¤) + ìˆ˜ê¸‰(ê±°ë˜ëŸ‰)â€ ê¸°ë°˜ ì£¼ì‹ ê²€ìƒ‰ê¸°  
> ê¸°ì¤€ì¼ì„ ì…ë ¥í•˜ë©´ í…Œë§ˆâ†’ì¢…ëª© ë‹¨ìœ„ë¡œ ìŠ¤ìº”í•˜ê³  ê·¸ë£¹ A/Bë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.

---

## 1. ëª©ì 
íˆ¬ì íŒë‹¨ì— ì•ì„œ â€œì™œ ì´ ì¢…ëª©/í…Œë§ˆê°€ ì›€ì§ì˜€ëŠ”ì§€â€ë¥¼  
**ê±°ë˜ëŸ‰ ê¸‰ì¦(ìˆ˜ê¸‰) + ìµœê·¼ ë‰´ìŠ¤(ì´ìŠˆ)**ë¡œ êµ¬ì¡°í™”í•´ ì„¤ëª…í•©ë‹ˆë‹¤.

- ëŒ€ìƒ: ì½”ìŠ¤í”¼/ì½”ìŠ¤ë‹¥
- ê¸°ì¤€ì¼: ì‚¬ìš©ì ì§€ì •(ê¸°ë³¸ ì˜¤ëŠ˜)
- ë‹¨ìœ„: í…Œë§ˆ â†’ ì¢…ëª©

---

## 2. í•µì‹¬ ê¸°ëŠ¥
- ì‚¬ì „ ì •ì˜ëœ í…Œë§ˆ ëª©ë¡(theme_universe) ê¸°ë°˜ ìŠ¤ìº”
- ê±°ë˜ëŸ‰ ê¸‰ì¦ + ê±°ë˜ëŒ€ê¸ˆ í•„í„°ë¡œ â€œìˆ˜ê¸‰ ìœ ì… ì¢…ëª©â€ íƒì§€
- ìµœê·¼ 1~3ì¼ ë‰´ìŠ¤ ê¸°ë°˜ â€œìœ íš¨ ì´ìŠˆâ€ íŒë³„
- ì¢…ëª©ì„ ê·¸ë£¹ A/Bë¡œ ë¶„ë¥˜
  - A: ì´ìŠˆ + ìˆ˜ê¸‰ ë™ë°˜
  - B: ë¬´ì´ìŠˆ + ìˆ˜ê¸‰ ì„ í–‰(ì¤‘ì )
- í…Œë§ˆ ìƒíƒœë¥¼ í•œ ì¤„ë¡œ ìš”ì•½(ì§€ì†/ì¬ì í™” ê°€ì„¤)

---

## 3. ì¢…ëª© ìŠ¤ìº” ì¡°ê±´
ê° ì¢…ëª©ì— ëŒ€í•´:
- AVG_VOL_20: ìµœê·¼ 20ê±°ë˜ì¼ í‰ê·  ê±°ë˜ëŸ‰
- TODAY_VOL: ê¸°ì¤€ì¼ ê±°ë˜ëŸ‰
- VOL_RATIO = TODAY_VOL / AVG_VOL_20
- TODAY_VALUE: ê¸°ì¤€ì¼ ê±°ë˜ëŒ€ê¸ˆ

ìœ íš¨ ì¡°ê±´:
- TODAY_VALUE â‰¥ 50ì–µ
- VOL_RATIO â‰¥ 2.0

---

## 4. ë‰´ìŠ¤(ì´ìŠˆ) íŒë³„ ê¸°ì¤€
ê¸°ì¤€ì¼ í¬í•¨ ìµœê·¼ 1~3ì¼ ë‚´ ì¢…ëª© ê´€ë ¨ ë‰´ìŠ¤ ì¡´ì¬ ì—¬ë¶€(HAS_NEWS)

ìœ íš¨ ì´ìŠˆ ì¸ì • ë²”ìœ„:
1) ì •ì±…/ì œë„/ì •ë¶€ ë°œí‘œ
2) ì‹¤ì /ìˆ˜ì£¼/ê³„ì•½/ê¸°ìˆ /ê·œì œ
3) í…Œë§ˆì™€ ì§ì ‘ ì—°ê²°ë˜ëŠ” ì‚°ì—… ì´ìŠˆ

ì œì™¸:
- ë‹¨ìˆœ ì–¸ê¸‰, ë°˜ë³µ ê¸°ì‚¬, ì˜ë¯¸ ì—†ëŠ” ì†Œì‹

---

## 5. ë¶„ë¥˜ ë¡œì§
[ê·¸ë£¹ A] HAS_NEWS=True & VOL_RATIOâ‰¥2.0  
â†’ â€œìˆ˜ê¸‰ + ë‰´ìŠ¤ë¡œ í…Œë§ˆ ìƒìŠ¹ì´ ìœ ì§€Â·í™•ì‚°(ê°€ì„¤)â€

[ê·¸ë£¹ B] HAS_NEWS=False & VOL_RATIOâ‰¥2.0  
â†’ â€œë‰´ìŠ¤ëŠ” ì—†ìœ¼ë‚˜ ìˆ˜ê¸‰ ì„ í–‰ ìœ ì… â†’ ë‹¤ìŒ ì´ìŠˆ í›„ë³´(ê°€ì„¤)â€

---

## 6. í…Œë§ˆ ìƒíƒœ í•´ì„(í•œ ì¤„ ìš”ì•½)
- ê·¸ë£¹ A ë‹¤ìˆ˜: í…Œë§ˆ ì§€ì† êµ­ë©´
- ê·¸ë£¹ B ì„ ì¶œí˜„: í…Œë§ˆ ì¬ì í™”/ì‹ ê·œ ê°€ëŠ¥ì„±(ê°€ì„¤)

---

## 7. ì¶œë ¥ ì˜ˆì‹œ
â–  í…Œë§ˆëª…
- í…Œë§ˆ ìƒíƒœ ìš”ì•½: (ì˜ˆ) ì‚¬ì „ ìˆ˜ê¸‰ â†’ ë‰´ìŠ¤ ë™ë°˜ ìƒìŠ¹ ìœ ì§€

[ê·¸ë£¹ A] ì´ìŠˆ + ê±°ë˜ëŸ‰
- ì¢…ëª© | VOL_RATIO | ê±°ë˜ëŒ€ê¸ˆ | ê´€ë ¨ ë‰´ìŠ¤ ìš”ì•½

[ê·¸ë£¹ B] ë¬´ì´ìŠˆ + ê±°ë˜ëŸ‰ ì„ í–‰
- ì¢…ëª© | VOL_RATIO | ê±°ë˜ëŒ€ê¸ˆ | ì¶”ì • ì‹œë‚˜ë¦¬ì˜¤(ê°€ì„¤)

---

## 8. ê¸°ìˆ  ìŠ¤íƒ
- Backend: FastAPI, Python, Pandas, SQLAlchemy
- DB: MySQL
- Frontend: Flutter Web
- Scheduler: cron / APScheduler

---

## 9. ë¡œë“œë§µ
- [ ] ë‰´ìŠ¤ ìœ íš¨ì„± ë¶„ë¥˜ ê·œì¹™ ê³ ë„í™”(ì •ì±…/ì‹¤ì /ê¸°ìˆ /ê·œì œ)
- [ ] ê±°ë˜ì¼ ìº˜ë¦°ë” ì²˜ë¦¬ ë° íœ´ì¥ì¼ ë³´ì •
- [ ] í…Œë§ˆ ìë™ í™•ì¥(í›„ìˆœìœ„)

## ğŸ¯ Stock_Issue_Scanner í”„ë¡œì íŠ¸ ëª©ì  + ì„¤ê³„ ì² í•™

### í•œ ì¤„ ì •ì˜

**ì´ìŠˆ(ë‰´ìŠ¤)ì™€ ìˆ˜ê¸‰(ê±°ë˜ëŸ‰)ì„ ê²°í•©í•´
í•œêµ­ ì£¼ì‹ ì‹œì¥ì˜ â€˜í…Œë§ˆ íë¦„â€™ì„ ìŠ¤ìº”Â·ë¶„ë¥˜í•˜ëŠ” ì‹œìŠ¤í…œ**

---

### ëŒ€ìƒ

- ì‹œì¥: **KOSPI / KOSDAQ**
- ë‹¨ìœ„:
    - í…Œë§ˆ â†’ ì¢…ëª©
    - ë‚ ì§œ ë‹¨ìœ„ ìŠ¤ìº”

---

### í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ

- â€œì˜¤ëŠ˜ ì‹œì¥ì—ì„œ ì–´ë–¤ í…Œë§ˆê°€ ì™œ ì›€ì§ì˜€ëŠ”ì§€â€ëŠ” ê°ìœ¼ë¡œ íŒë‹¨ë¨
- ë‰´ìŠ¤ë§Œ ë³´ë©´ ëŠ¦ê³ , ê±°ë˜ëŸ‰ë§Œ ë³´ë©´ ì´ìœ ê°€ ë¶ˆëª…í™•
- **ì´ìŠˆ + ìˆ˜ê¸‰ì„ ë™ì‹œì— ë³´ëŠ” êµ¬ì¡°ì  ë„êµ¬ ë¶€ì¡±**

---

### ì´ í”„ë¡œì íŠ¸ê°€ ì œê³µí•˜ë ¤ëŠ” ê²ƒ

- í…Œë§ˆë³„ë¡œ:
    - ì´ìŠˆ ë™ë°˜ ì¢…ëª©
    - ë¬´ì´ìŠˆ ìˆ˜ê¸‰ ì„ í–‰ ì¢…ëª©
        
        ë¥¼ **êµ¬ì¡°ì ìœ¼ë¡œ ë¶„ë¥˜**
        

### 1ï¸âƒ£ ë°ì´í„°ëŠ” â€œìŒ“ì—¬ì•¼ ì˜ë¯¸ê°€ ìˆë‹¤â€

- ì£¼ì‹ì€ í•˜ë£¨ ë°ì´í„°ë§Œ ë³´ë©´ ì˜ë¯¸ ì—†ìŒ
- ê³¼ê±° ëŒ€ë¹„, ì§€ì†ì„±, ë³€í™” íë¦„ì´ ì¤‘ìš”
    
    â†’ **DB ì¤‘ì‹¬ êµ¬ì¡° ì„ íƒ**
    

---

### 2ï¸âƒ£ ëª¨ë“  í•´ì„ì€ â€œì¬í˜„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤â€

- íŠ¹ì • ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì‹œ ìŠ¤ìº” ê°€ëŠ¥í•´ì•¼ í•¨
- â€œê·¸ë‚  ì™œ ì´ í…Œë§ˆì˜€ëŠ”ì§€â€ë¥¼ ë‚˜ì¤‘ì— ì„¤ëª… ê°€ëŠ¥í•´ì•¼ í•¨
    
    â†’ ë‚ ì§œ ê¸°ì¤€ ìŠ¤ìº” + DB ëˆ„ì  êµ¬ì¡°
    

---

### 3ï¸âƒ£ ì˜ˆì¸¡ì´ ì•„ë‹ˆë¼ â€œê°€ì„¤ ì œì‹œâ€

- ì´ í”„ë¡œì íŠ¸ëŠ” ìë™ë§¤ë§¤/ì˜ˆì¸¡ ì‹œìŠ¤í…œì´ ì•„ë‹˜
- **ë°ì´í„° ê¸°ë°˜ ê°€ì„¤ ìƒì„± ë„êµ¬**
    
    â†’ ê²°ê³¼ëŠ” â€œí™•ì •â€ì´ ì•„ë‹Œ â€œí•´ì„/ì‹œë‚˜ë¦¬ì˜¤â€ë¡œ í‘œí˜„
    

---

### 4ï¸âƒ£ ì‹¤ë¬´ í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°

- ë¡œì»¬ â†’ í´ë¼ìš°ë“œ ì´ì „ ìš©ì´
- API/DB/ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ë¦¬
- í˜‘ì—…/ë°°í¬ ê³ ë ¤í•œ êµ¬ì¡°



## alembic ì‰˜ ì‹¤í–‰ìˆœì„œ

## ì‘ì„± ìˆœì„œ upgrade â†’ revision â†’ upgrade

> **í•­ìƒ DBë¥¼ ìµœì‹  migration ìƒíƒœë¡œ ë§ì¶˜ í›„ì—
ìƒˆ revisionì„ ë§Œë“ ë‹¤**
> 

`alembic upgrade head  # db ë¥¼ ì§€ê¸ˆê¹Œì§€ ë§Œë“¤ì–´ì˜¨ ëª¨ë“  ë¦¬ë¹„ì ¼ ìƒíƒœë¡œ ë§ì¶¤
alembic revision --autogenerate -m"..." # í˜„ì¬ db ìƒíƒœì™€ í˜„ì¬ orm ì½”ë“œì˜ ì°¨ì´ë¥´ ã„¹ë¹„êµí•˜ì—¬ ìƒˆë¡œ ë°”ë€ êµ¬ì¡°ë§Œ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ë¡œ ìƒì„±
alembic upgradehead  # ë°©ê¸ˆë§Œë“  ìƒˆ ë¦¬ë¹„ì ¼ì„ ì‹¤ì œ db ì— ì ìš©`

current ë‘ history ë§ì¶”ê¸° 

### ğŸ” `alembic current`

```bash
alembic current
```

- DBê°€ **ì–´ëŠ revisionê¹Œì§€ ì ìš©ëëŠ”ì§€** ì•Œë ¤ì¤Œ

---

### ğŸ” `alembic heads`

```bash
alembic heads
```

- ë¡œì»¬ migration ê¸°ë¡ ì¤‘
- *ê°€ì¥ ìµœì‹  revision(head)**ì´ ë­”ì§€ ì•Œë ¤ì¤Œ

---

### ğŸ” `alembic history`

```bash
alembichistory --verbose
```

- migration ì „ì²´ ì—­ì‚¬ íƒ€ì„ë¼ì¸
- â€œì–´ë–¤ revisionì´ ì–´ë–¤ ìˆœì„œë¡œ ìŒ“ì˜€ëŠ”ì§€â€

```text
issue-flow-scanner/
â”œâ”€ README.md
â”œâ”€ .env.example
â”œâ”€ docker-compose.yml                 # MySQL + backend
â”œâ”€ docs/
â”‚  â”œâ”€ erd.png
â”‚  â”œâ”€ api.md
â”‚  â””â”€ rules.md                        # ë‰´ìŠ¤ ìœ íš¨ ì´ìŠˆ ê·œì¹™/í‚¤ì›Œë“œ
â”œâ”€ data/
â”‚  â””â”€ seed/
â”‚     â”œâ”€ theme_universe.csv           # í…Œë§ˆ-ì¢…ëª© ë§µ
â”‚     â””â”€ issue_rules.yaml             # ìœ íš¨ ì´ìŠˆ ë¶„ë¥˜ ê·œì¹™ (ì •ì±…/ì‹¤ì /ê¸°ìˆ /ê·œì œ/ì‚°ì—…)
â”‚
â”œâ”€ backend/
â”‚  â”œâ”€ api/
â”‚  â”‚  â”œâ”€ main.py                      # FastAPI ì—”íŠ¸ë¦¬
â”‚  â”‚  â”œâ”€ deps.py
â”‚  â”‚  â”œâ”€ routers/
â”‚  â”‚  â”‚  â”œâ”€ scan.py                   # í•µì‹¬ API: /scan?date=YYYY-MM-DD
â”‚  â”‚  â”‚  â”œâ”€ themes.py                 # /themes/{date} (ìš”ì•½ ë¦¬ìŠ¤íŠ¸)
â”‚  â”‚  â”‚  â””â”€ health.py
â”‚  â”‚  â””â”€ schemas/
â”‚  â”‚     â”œâ”€ scan.py                   # í…Œë§ˆë³„ Group A/B ì‘ë‹µ ìŠ¤í‚¤ë§ˆ
â”‚  â”‚     â”œâ”€ theme.py
â”‚  â”‚     â””â”€ news.py
â”‚  â”‚
â”‚  â”œâ”€ core/
â”‚  â”‚  â”œâ”€ config.py
â”‚  â”‚  â”œâ”€ cors.py                      # Flutter Web ì—°ë™ìš© CORS
â”‚  â”‚  â””â”€ constants.py                 # VOL_RATIO â‰¥ 2, VALUE â‰¥ 50ì–µ ë“±
â”‚  â”‚
â”‚  â”œâ”€ db/
â”‚  â”‚  â”œâ”€ session.py
â”‚  â”‚  â”œâ”€ base.py
â”‚  â”‚  â”œâ”€ models/
â”‚  â”‚  â”‚  â”œâ”€ theme_universe.py
â”‚  â”‚  â”‚  â”œâ”€ market_daily.py
â”‚  â”‚  â”‚  â”œâ”€ news_raw.py
â”‚  â”‚  â”‚  â”œâ”€ news_stock_map.py         # ë‰´ìŠ¤â€“ì¢…ëª© ë§¤í•‘
â”‚  â”‚  â”‚  â””â”€ scan_result_daily.py      # ë‚ ì§œë³„ ìŠ¤ìº” ê²°ê³¼ ìºì‹œ
â”‚  â”‚  â””â”€ migrations/
â”‚  â”‚
â”‚  â”œâ”€ collector/
â”‚  â”‚  â”œâ”€ market_daily.py              # ì¢…ëª© ê±°ë˜ëŸ‰/ê±°ë˜ëŒ€ê¸ˆ ìˆ˜ì§‘
â”‚  â”‚  â”œâ”€ news_daily.py                # ë‰´ìŠ¤ ìˆ˜ì§‘ + ì¤‘ë³µ ì œê±°
â”‚  â”‚  â”œâ”€ loaders.py                   # theme_universe seed ì ì¬
â”‚  â”‚  â””â”€ sources/
â”‚  â”‚     â”œâ”€ market_source.py
â”‚  â”‚     â””â”€ news_source.py
â”‚  â”‚
â”‚  â”œâ”€ issue/
â”‚  â”‚  â”œâ”€ dedup.py                     # ë‰´ìŠ¤ ì¤‘ë³µ ì œê±° (hash)
â”‚  â”‚  â”œâ”€ classifier.py                # ìœ íš¨ ì´ìŠˆ íŒë³„ (ê·œì¹™ ê¸°ë°˜)
â”‚  â”‚  â”œâ”€ stock_linker.py              # ë‰´ìŠ¤ â†’ ì¢…ëª© ë§¤ì¹­
â”‚  â”‚  â””â”€ summarizer.py                # ë‰´ìŠ¤ 1ì¤„ ìš”ì•½ (ë£°/ì˜µì…˜ LLM)
â”‚  â”‚
â”‚  â”œâ”€ scanner/
â”‚  â”‚  â”œâ”€ run_scan.py                  # í•µì‹¬ ì—”ì§„: date â†’ ìŠ¤ìº” ê²°ê³¼ ìƒì„±
â”‚  â”‚  â”œâ”€ volume_filter.py             # AVG_VOL_20, VOL_RATIO, VALUE ì¡°ê±´
â”‚  â”‚  â”œâ”€ group_assign.py              # Group A / B ë¶„ë¥˜
â”‚  â”‚  â”œâ”€ theme_state.py               # í…Œë§ˆ ìƒíƒœ í•œ ì¤„ ìš”ì•½
â”‚  â”‚  â””â”€ cache.py                     # scan_result_daily ì €ì¥/ì¡°íšŒ
â”‚  â”‚
â”‚  â””â”€ utils/
â”‚     â”œâ”€ trading_calendar.py          # ê±°ë˜ì¼/íœ´ì¥ì¼ ì²˜ë¦¬
â”‚     â”œâ”€ formatters.py                # ê±°ë˜ëŒ€ê¸ˆ í¬ë§·
â”‚     â””â”€ dates.py
â”‚
â”œâ”€ frontend/                          # Flutter Web
â”‚  â”œâ”€ pubspec.yaml
â”‚  â”œâ”€ web/
â”‚  â””â”€ lib/
â”‚     â”œâ”€ main.dart
â”‚     â”œâ”€ app.dart
â”‚     â”œâ”€ routes/
â”‚     â”‚  â””â”€ app_router.dart           # /, /theme/:name?date=...
â”‚     â”œâ”€ pages/
â”‚     â”‚  â”œâ”€ scan_page.dart            # ë‚ ì§œ ì„ íƒ + ì „ì²´ í…Œë§ˆ ìŠ¤ìº”
â”‚     â”‚  â””â”€ theme_detail_page.dart    # í…Œë§ˆ ìƒì„¸ (Group A/B)
â”‚     â”œâ”€ widgets/
â”‚     â”‚  â”œâ”€ theme_section.dart        # í…Œë§ˆ ë¸”ë¡ + ìƒíƒœ ìš”ì•½
â”‚     â”‚  â”œâ”€ group_table.dart          # Group A/B í…Œì´ë¸”
â”‚     â”‚  â”œâ”€ news_chips.dart           # ë‰´ìŠ¤ ìš”ì•½/ë§í¬
â”‚     â”‚  â””â”€ date_picker_bar.dart
â”‚     â”œâ”€ models/
â”‚     â”‚  â”œâ”€ scan_result.dart
â”‚     â”‚  â”œâ”€ stock_item.dart
â”‚     â”‚  â””â”€ news_item.dart
â”‚     â”œâ”€ services/
â”‚     â”‚  â”œâ”€ api_client.dart
â”‚     â”‚  â””â”€ scan_service.dart         # /scan API í˜¸ì¶œ
â”‚     â”œâ”€ state/
â”‚     â”‚  â””â”€ scan_provider.dart        # ìƒíƒœ ê´€ë¦¬ (Riverpod/Provider)
â”‚     â””â”€ utils/
â”‚        â””â”€ format.dart
â”‚
â””â”€ tests/
   â”œâ”€ test_volume_filter.py
   â”œâ”€ test_issue_classifier.py
   â””â”€ test_scanner.py
